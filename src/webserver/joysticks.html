<!DOCTYPE HTML>
<html>
    <head>
        <title>Joy</title>
        <meta charset="utf-8">
        <meta name="description" content="ESP32 Remote Controller for Car">
        <meta name="author" content="Matan Levy">
        <script src="https://levymatan.github.io/JoyStick/joy.js"></script>
        <style>
            .joystick-container {
                display: inline-block;
                vertical-align: top;
                margin-right: 20px;
            }
        </style>
    </head>

    <body>
        <div class="joystick-container">
            <p id="turn-value">Turn Value: </p>
            <div id="joyDiv-turn" style="width:200px;height:200px;"></div>
        </div>
        <div class="joystick-container">
            <p id="speed-value">Speed Value: </p>
            <div id="joyDiv-speed" style="width:200px;height:200px;"></div>
        </div>
        <script type="text/javascript">
            var speed = 0;
            var turn = 0;
            function sendGetWithParams(speed_arg, turn_arg)
            {
                var xhttp = new XMLHttpRequest();
                var arg = speed_arg + "," + turn_arg;
                xhttp.open('GET', 'move' + '?' + arg, true); 
                xhttp.send()
            }

            function updateHtmlInfo(speed_arg, turn_arg)
            {
                document.getElementById("speed-value").innerHTML = "Speed Value: " + speed_arg;
                document.getElementById("turn-value").innerHTML = "Turn Value: " + turn_arg;
            }
                                    
            var JoyTurn = new JoyStick('joyDiv-turn', {}, function(stickData) {
                turn = stickData.x;
                updateHtmlInfo(speed, turn);
                sendGetWithParams(speed, turn);
            });
            
            var JoySpeed = new JoyStick('joyDiv-speed', {}, function(stickData) {
                speed = stickData.y;
                updateHtmlInfo(speed, turn);
                sendGetWithParams(speed, turn);
            });
        </script>
    </body>
</html>